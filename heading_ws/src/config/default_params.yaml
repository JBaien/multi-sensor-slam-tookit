# 姿态估计节点配置
# 复制此文件并根据需要自定义

# 输入/输出话题
pointcloud_topic: "/timoo_points"
base_frame: "world"
lidar_frame: "timoo"
attitude_topic: "/pose_wall/attitude"
distances_topic: "/pose_wall/distances"

# 前进轴配置
# 选项: +X, -X, +Y, -Y
forward_axis: "+X"

# 车体尺寸（米）
vehicle_length: 4.5    # 车体长度
vehicle_width: 1.2     # 车体宽度
track_length: 1.4      # 履带长度
track_width: 1.0       # 履带间距

# 中轴线采样点位置（米）
# 定义沿设备中轴线测量墙距的位置
sample_front_dist: 0.5   # 中心前方0.5米
sample_back_dist: -0.5    # 中心后方0.5米

# 地面平面估计参数
ground_roi_radius: 5              # 地面拟合ROI半径（米）
ground_z_percentile: 0.3         # 选择地面点的高度分位数
ground_inlier_min: 30            # 有效地面的最小内点数
ground_normal_threshold: 5.0     # 法向与水平的最大偏差（度）
ground_ransac_max_iter: 500      # 地面RANSAC最大迭代次数
ground_ransac_threshold: 0.08    # 地面RANSAC内点距离阈值（米）
plane_inlier_threshold: 0.08     # 平面提取的内点距离阈值（米）

# 墙面平面估计参数
wall_z_min: 0.5                  # 墙面提取的最小高度（米）
wall_z_max: 3                    # 墙面提取的最大高度（米）
wall_z_percentile_min: 0.2       # 墙面提取的最小高度分位数（去除底部20%的最低点）
wall_z_percentile_max: 0.8       # 墙面提取的最大高度分位数（去除顶部20%的最高点）
wall_use_percentile_filter: true  # 是否使用分位数高度滤波（true:使用分位数, false:使用绝对高度值）
wall_inlier_min: 50             # 有效墙面的最小内点数
wall_vertical_threshold: 0.2     # 垂直平面的最大|n_z|（余弦阈值）
wall_parallel_cos: 0.9           # 平行墙验证的余弦阈值
wall_max_planes: 4               # 最大拟合墙面数量（用于筛选左右墙）
wall_side_cos_threshold: 0.3      # 判断是否为左右墙的余弦阈值（与前进轴的点积绝对值小于此值即为左右墙）
wall_ransac_max_iter: 300        # 墙面RANSAC最大迭代次数
wall_ransac_threshold: 0.05      # 墙面RANSAC内点距离阈值（米）
wall_distance_max: 100.0         # 墙距计算的最大有效距离（米）

# 滤波参数
voxel_size: 0.06                 # 体素网格滤波尺寸（米，从0.02提高到0.06避免整数溢出）
outlier_mean_k: 50               # 统计离群点移除的邻居数量
outlier_std_mul: 1.5             # 离群点移除的标准差倍数

# 时域平滑参数
temporal_smoothing_tau: 0.3      # 指数平滑的时间常数（秒）
max_yaw_rate: 0.05236           # 最大航向角变化率（弧度/帧，约3度）

# 质量阈值
ground_max_rms: 0.10             # 地面平面的最大RMS误差（米）
wall_max_rms: 0.15               # 墙面平面的最大RMS误差（米）
